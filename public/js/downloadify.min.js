/* Downloadify 0.2 (c) 2009 by Douglas Neiner. Licensed under the MIT license */
/* See http://github.com/dcneiner/Downloadify for license and more info */
(function(){Downloadify=window.Downloadify={queue:{},uid:new Date().getTime(),getTextForSave:function(a){var b=Downloadify.queue[a];if(b){return b.getData()}return""},getFileNameForSave:function(a){var b=Downloadify.queue[a];if(b){return b.getFilename()}return""},getDataTypeForSave:function(a){var b=Downloadify.queue[a];if(b){return b.getDataType()}return""},saveComplete:function(a){var b=Downloadify.queue[a];if(b){b.complete()}return true},saveCancel:function(a){var b=Downloadify.queue[a];if(b){b.cancel()}return true},saveError:function(a){var b=Downloadify.queue[a];if(b){b.error()}return true},addToQueue:function(a){Downloadify.queue[a.queue_name]=a},getUID:function(a){if(a.id==""){a.id="downloadify_"+Downloadify.uid++}return a.id}};Downloadify.create=function(c,a){var b=(typeof(c)=="string"?document.getElementById(c):c);return new Downloadify.Container(b,a)};Downloadify.Container=function(b,a){var c=this;c.el=b;c.enabled=true;c.dataCallback=null;c.filenameCallback=null;c.data=null;c.filename=null;var d=function(){c.options=a;if(!c.options.append){c.el.innerHTML=""}c.flashContainer=document.createElement("span");c.el.appendChild(c.flashContainer);c.queue_name=Downloadify.getUID(c.flashContainer);if(typeof(c.options.filename)==="function"){c.filenameCallback=c.options.filename}else{if(c.options.filename){c.filename=c.options.filename}}if(typeof(c.options.data)==="function"){c.dataCallback=c.options.data}else{if(c.options.data){c.data=c.options.data}}var g={queue_name:c.queue_name,width:c.options.width,height:c.options.height};var f={allowScriptAccess:"always"};var e={id:c.flashContainer.id,name:c.flashContainer.id};if(c.options.enabled===false){c.enabled=false}if(c.options.transparent===true){f.wmode="transparent"}if(typeof c.options.downloadImage!="undefined"){g.downloadImage=c.options.downloadImage}swfobject.embedSWF(c.options.swf,c.flashContainer.id,c.options.width,c.options.height,"10",null,g,f,e);Downloadify.addToQueue(c)};c.enable=function(){var e=document.getElementById(c.flashContainer.id);e.setEnabled(true);c.enabled=true};c.disable=function(){var e=document.getElementById(c.flashContainer.id);e.setEnabled(false);c.enabled=false};c.getData=function(){if(!c.enabled){return""}if(c.dataCallback){return c.dataCallback()}else{if(c.data){return c.data}else{return""}}};c.getFilename=function(){if(c.filenameCallback){return c.filenameCallback()}else{if(c.filename){return c.filename}else{return""}}};c.getDataType=function(){if(c.options.dataType){return c.options.dataType}return"string"};c.complete=function(){if(typeof(c.options.onComplete)==="function"){c.options.onComplete()}};c.cancel=function(){if(typeof(c.options.onCancel)==="function"){c.options.onCancel()}};c.error=function(){if(typeof(c.options.onError)==="function"){c.options.onError()}};d()};Downloadify.defaultOptions={swf:"media/downloadify.swf",downloadImage:"images/download.png",width:100,height:30,transparent:true,append:false,dataType:"string"}})();if(typeof(jQuery)!="undefined"){(function(a){a.fn.downloadify=function(b){return this.each(function(){b=a.extend({},Downloadify.defaultOptions,b);var c=Downloadify.create(this,b);a(this).data("Downloadify",c)})}})(jQuery)}if(typeof(MooTools)!="undefined"){Element.implement({downloadify:function(a){a=$merge(Downloadify.defaultOptions,a);return this.store("Downloadify",Downloadify.create(this,a))}})};